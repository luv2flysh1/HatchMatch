HATCHMATCH - ARCHITECTURE SUMMARY
==================================

A quick overview of how the app is built.


TECHNOLOGY STACK
----------------

MOBILE APP:
- Expo (React Native) - builds for both iPhone and Android
- Expo Router - screen navigation
- Zustand - app state management

BACKEND (Supabase):
- Authentication - user accounts, login
- PostgreSQL Database - all app data
- Storage - photo uploads
- Edge Functions - API endpoints

EXTERNAL SERVICES:
- Claude AI - generates fly recommendations
- Weather API - current conditions and forecast
- Google Maps - fly shop search and directions
- USGS - river flow rates and water temperature


HOW FLY RECOMMENDATIONS WORK
----------------------------

1. User views a water body in the app

2. App calls backend API

3. Backend gathers context:
   - Water body info (type, species, location)
   - Current weather + forecast
   - River flow rate and water temp (if available)
   - Seasonal hatch chart data
   - Recent catch reports from other users

4. Backend sends all context to Claude AI

5. Claude returns fly recommendations with:
   - Fly name and size
   - Confidence level
   - Reasoning (why this fly)
   - Technique tips

6. Results cached to avoid repeated API calls

7. App displays recommendations


API COSTS (Claude AI)
---------------------

Using Claude Haiku (recommended for cost efficiency):

Cost per recommendation: ~$0.004 - $0.005 (less than half a cent)

Monthly projections:
- 10,000 requests:  ~$40-50
- 50,000 requests:  ~$200-250
- 100,000 requests: ~$400-500

Cost optimization built-in:
- Aggressive caching (same water + date = no API call)
- Batch requests for multi-water trips
- Smart cache expiry (12-24 hours)


APP SCREENS
-----------

- Home/Search: Find waters by name or nearby
- Water Detail: View recommendations, conditions, reports
- Trips: Plan and manage fishing trips
- Shops: Find fly shops with directions
- Profile: Settings, subscription, favorites


DATABASE TABLES
---------------

Core tables:
- users - account info, preferences, subscription tier
- water_bodies - rivers, lakes, streams
- flies - fly patterns with images and info
- trips - user trip plans
- trip_waters - waters included in each trip
- catch_reports - user-submitted catch data
- favorites - saved water bodies
- fly_shops - shop locations and info
- hatch_charts - regional hatch data by month
- subscriptions - premium subscription tracking
- recommendation_cache - cached AI recommendations


SECURITY
--------

- All user data protected by Row Level Security
- Users can only access their own trips, reports, favorites
- Public catch reports visible to all users
- Authentication via Supabase Auth (email + social login)


DATA FLOW EXAMPLE: PLANNING A TRIP
----------------------------------

1. User creates new trip with date
2. User searches and adds water bodies to trip
3. App fetches recommendations for each water
4. Trip saved to database
5. Premium users: recommendations auto-refresh on app open
6. User can find fly shops along the route
7. User can tap to get directions in maps app


OFFLINE MODE (Premium)
----------------------

- Download trip data before leaving
- Recommendations and shop info cached locally
- Syncs back to server when online


==================================
For detailed technical specs, see ARCHITECTURE.md
